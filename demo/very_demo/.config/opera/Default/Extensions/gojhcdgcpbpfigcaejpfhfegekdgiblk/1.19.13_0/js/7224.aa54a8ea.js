"use strict";(self["webpackChunkdesktop_wallet"]=self["webpackChunkdesktop_wallet"]||[]).push([[7224],{84103:function(t,e,s){s.d(e,{Z:function(){return _}});var i=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"w-full"},[t.value?e("div",{staticClass:"bg-input-bg cursor-pointer flex rounded-full t-asset_selector-show_dialog",on:{click:t.showDialog}},[e("token-icon",{staticClass:"h-8 mx-4 my-5 w-10",attrs:{address:t.address,chain:t.chain}}),e("div",{staticClass:"flex items-center justify-between truncate w-full"},[e("div",{staticClass:"tracking-wider truncate"},[e("div",{staticClass:"font-bold text-lg truncate"},[t._v(t._s(t.name))]),e("div",{staticClass:"flex font-bold items-center text-grey-A text-sm truncate"},[e("span",{staticClass:"mr-2"},[t._v(t._s(t.symbol))]),e("chain-badge",{attrs:{chain:t.chain}})],1)]),e("i",{staticClass:"icon-chevron_down m-4 text-dark-N60 w-6"})])],1):t._e(),e("asset-selector-dialog",{ref:"dialog",attrs:{options:t.options,"still-loading-count":t.stillLoadingCount,value:t.value}})],1)},a=[],n=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{directives:[{name:"show",rawName:"v-show",value:t.showing,expression:"showing"}],staticClass:"bg-background bottom-0 fixed left-0 right-0 top-0 z-30"},[e("div",{staticClass:"flex flex-col h-full"},[e("top-bar",{attrs:{"emit-back":"","test-parent-name":"asset_selector_dialog",title:t.$t("general.selectAssets")},on:{back:t.close}}),e("div",{staticClass:"px-4"},[e("opera-input",{staticClass:"t-token_dialog-query",attrs:{placeholder:t.$t("general.search"),"prepend-icon":"icon-search text-brand-primary text-opacity-40",type:"search",value:t.search},on:{input:t.updateSearch}})],1),e("div",{staticClass:"h-full overflow-y-scroll pb-4 px-4",on:{scroll:t.onScroll}},[t.loading&&t.search?e("div",{staticClass:"flex flex-1 items-center justify-center w-full"},[e("i",{staticClass:"animate-spin icon-spinner text-xl"})]):[t._l(t.tokenList,(function(s,i){return e("div",{key:i},[e("token-item",{staticClass:"my-3",attrs:{address:"contract"in s?s.contract.contract:s.address,chain:s.chain,name:"contract"in s?s.contract.name:s.name,selectable:!1,symbol:"contract"in s?s.contract.symbol:s.symbol,value:s},on:{change:t.itemClicked}})],1)})),e("back-to-top")],t._l(t.stillLoadingCount,(function(t){return e("div",{key:`loading-${t}`,staticClass:"bg-dark-N16 border border-black border-opacity-10 cursor-wait flex items-center justify-between mb-2 mt-3 px-6 py-3 rounded-lg t-token_loading_item",style:{opacity:1/t}},[e("div",{staticClass:"h-10"},[e("lottie-component",{staticClass:"h-10",attrs:{src:"loader_tx.json"}})],1)])}))],2)],1)])},o=[],r=s(72232),l=s(76501),c=s(14957),u=s(8893),h=s(69986),d=s(20144);const p=20;var m=d.ZP.extend({name:"AssetSelectorDialog",components:{BackToTop:r.Z,LottieComponent:l.Z,OperaInput:c.Z,TokenItem:u.Z,TopBar:h.Z},props:{options:{default:void 0,type:Array},stillLoadingCount:{default:0,type:Number},value:{default:void 0,type:Object}},data(){return{callback:null,loading:!1,pageSize:p,search:"",showing:!1}},computed:{tokenList(){const{tokens:t}=this;return this.search?t.filter(this.applyTokenSearchFilter).slice(0,this.pageSize):t.slice(0,this.pageSize)},tokens(){return this.options}},methods:{applyTokenSearchFilter(t){const e="contract"in t?t.contract.name:t.name,s=this.$store.getters.chainNameFriendly(t.chain),i="contract"in t?t.contract.symbol:t.symbol;return e.toLowerCase().includes(this.search.toLowerCase())||i.toLowerCase().includes(this.search.toLowerCase())||s.toLowerCase().includes(this.search.toLowerCase())},close(){!this.value||this.$route.meta?.preselectToken?this.$router.go(-1):this.showing=!1},async itemClicked(t){this.loading=!0,this.callback(t),this.showing=!1,this.loading=!1},onScroll(t){const{target:e}=t,s=e.scrollTop+e.clientHeight>=e.scrollHeight-e.clientHeight;s&&(this.pageSize+p<this.tokens.length?this.pageSize+=p:this.pageSize=this.tokens.length-1)},show(t){this.callback=t,this.showing=!0},updateSearch(t){this.search=t}}}),k=m,y=s(1001),g=(0,y.Z)(k,n,o,!1,null,null,null),f=g.exports,b=s(43130),v=s(92266),w=d.ZP.extend({name:"AssetSelector",components:{AssetSelectorDialog:f,ChainBadge:b.Z,TokenIcon:v.Z},props:{options:{default:void 0,type:Array},stillLoadingCount:{default:0,type:Number},value:{default:void 0,type:Object}},data(){return{dialog:!1}},computed:{address(){return"contract"in this.token?this.token.contract.contract:this.token.address},chain(){return this.token.chain},name(){return"contract"in this.token?this.token.contract.name:this.token.name},preselectToken(){return this.$route.meta?.preselectToken},symbol(){return"contract"in this.token?this.token.contract.symbol:this.token.symbol},token(){return this.value??this.$store.getters.matchingNativeToken("",this.chain)}},mounted(){this.preselectToken&&this.showDialog()},activated(){this.preselectToken&&"SendToken"===this.$route.name&&this.showDialog()},methods:{showDialog(){this.$refs.dialog.show((t=>{const{meta:e}=this.$route;e&&e.preselectToken&&(e.preselectToken=!1),this.$emit("input",t)}))}}}),C=w,x=(0,y.Z)(C,i,a,!1,null,null,null),_=x.exports},14933:function(t,e,s){s.r(e),s.d(e,{default:function(){return p}});var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"flex flex-col tracking-wide"},[e("top-bar",{attrs:{"test-parent-name":"buy_view",title:t.$t("general.buy")}}),e("div",{staticClass:"mt-5 mx-14",class:[{"overflow-hidden":t.isSelectingToken}]},[e("div",{staticClass:"mb-8 text-white"},[t._v(t._s(t.$t("views.buyView.buyDescription")))]),e("div",{staticClass:"mb-4 text-grey-D text-lg"},[t._v(t._s(t.$t("general.asset")))]),e("div",{staticClass:"flex items-center justify-center mb-12"},[e("asset-selector",{ref:"assetSelector",attrs:{options:t.buyableTokens},model:{value:t.token,callback:function(e){t.token=e},expression:"token"}})],1),e("div",{staticClass:"mb-4 text-grey-D text-lg"},[t._v(t._s(t.$t("general.serviceProvider")))]),t._l(t.promos.filter((t=>!t.hidden)),(function(s){return e("li",{key:s.key,staticClass:"bg-dark-N16 list-none mb-8 px-8 py-6 rounded-md",class:s.addClass},[e("img",{staticClass:"-ml-2 mr-6",attrs:{src:s.icon}}),e("div",{staticClass:"flex flex-col"},[e("div",{staticClass:"font-semibold mt-4 tracking-wider"},[t._v(" "+t._s(s.title)+" ")]),e("div",{staticClass:"font-light mt-2 text-dark-N77 tracking-normal"},[e("i18n",{attrs:{path:"views.buyView.buyWithDescription",tag:"span"},scopedSlots:t._u([{key:"platform",fn:function(){return[e("span",[t._v(t._s(s.platform))])]},proxy:!0},{key:"here",fn:function(){return[e("a",{staticClass:"underline",on:{click:function(e){return t.$platform.createNewTab({url:s.infoLink})}}},[t._v(" "+t._s(t.$t("general.here").toLocaleLowerCase(t.$i18n.locale))+" ")])]},proxy:!0}],null,!0)})],1),e("div",{staticClass:"flex flex-center mt-6"},[e("div",{staticClass:"flex-1"}),e("div",{staticClass:"t-buy_view-click",on:{click:function(e){return t.clickItem(s)}}},[e("primary-button",{staticClass:"flex-1 t-buy_view-action",attrs:{title:s.action}})],1),e("div",{staticClass:"flex-1"})]),s.supportLink?e("div",{staticClass:"font-semibold mt-2 text-center text-dark-N77 text-xs underline"},[e("a",{staticClass:"t-buy_view-contact",on:{click:function(e){return t.$platform.createNewTab({url:s.supportLink})}}},[t._v(" "+t._s(t.$t("general.support"))+" ")])]):t._e()])])}))],2)],1)},a=[],n=s(84103),o=s(25778),r=s(69790),l=s(69986),c={name:"BuyView",components:{AssetSelector:n.Z,PrimaryButton:o.Z,TopBar:l.Z},data(){return{isSelectingToken:!1,token:this.setDefaultBuyableToken()}},computed:{address(){return this.$store.getters.accountsByCoinType[this.coinType]},buyableTokens(){return this.$store.getters.buyableTokens},chain(){return this.token.chain},coinType(){return this.token.chain.coinType},isMoonPayBuyable(){return this.$store.getters.isMoonpayBuyable(this.token)},name(){return this.token.contract.name},promos(){const t=this.receivingAddress,e=this.$store.getters.productBuy,{symbol:i,symbolAliases:a}=this.token.contract;return[{action:this.$t("general.continueToPlatform",{platform:"MoonPay"}),hidden:!this.isMoonPayBuyable,icon:s(82820),infoLink:"https://support.moonpay.com/hc/",key:"moonpay",link:`https://satoshi.opera-api.com/v4/redirects/moonpay?currencyCode=${a.moonPay}&walletAddress=${t}&product=${e}`,platform:"MoonPay",stats:"wt_buy_moonpay",supportLink:"https://support.moonpay.com/hc/en-gb/requests/new",title:this.$t("views.buyView.buyWithTitle",{platform:"MoonPay",symbol:i})}]},receivingAddress(){return this.$store.getters.receivingAddress},statsPayload(){return{coin:this.token.contract.symbol,network:this.$store.getters.getNetworkName(this.chain)}}},watch:{token(){this.$store.dispatch("getReceivingAddress",this.chain)}},mounted(){this.$route.meta.preselectToken&&(r.Z.sendStatsEvent(r.Z.types.IMPRESSION,"wt_buy_entered",this.statsPayload),this.$store.dispatch("getReceivingAddress",this.chain)),this.$watch((()=>this.$refs.assetSelector.$refs.dialog.showing),(t=>{this.isSelectingToken=t}),{immediate:!0})},methods:{clickItem(t){t.stats&&r.Z.sendStatsEvent(r.Z.types.CLICK,t.stats,this.statsPayload);const{link:e}=t;this.$platform.createNewTab({url:e})},setDefaultBuyableToken(){return this.$store.getters.getBuyableToken(this.$route.params?.token)}}},u=c,h=s(1001),d=(0,h.Z)(u,i,a,!1,null,null,null),p=d.exports},82820:function(t,e,s){t.exports=s.p+"img/moonpay.8cd24a6f.svg"}}]);