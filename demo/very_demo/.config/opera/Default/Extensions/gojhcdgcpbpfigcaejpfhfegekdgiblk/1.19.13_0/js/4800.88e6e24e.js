"use strict";(self["webpackChunkdesktop_wallet"]=self["webpackChunkdesktop_wallet"]||[]).push([[4800],{90881:function(e,t,s){s.d(t,{Z:function(){return d}});var i=function(){var e=this,t=e._self._c;return t("transition",{attrs:{name:"fade"}},[t("div",{directives:[{name:"show",rawName:"v-show",value:e.showing,expression:"showing"}],staticClass:"bg-black bg-opacity-40 bottom-0 fixed flex items-center justify-center left-0 right-0 top-0 z-10"},[t("div",{staticClass:"bg-modal flex flex-col items-center max-w-screen-sm mx-10 my-10 px-10 py-7 rounded-lg w-full"},["success"===e.icon?t("img",{staticClass:"h-14 mb-6 w-14",attrs:{src:s(54398)}}):e._e(),e.title?t("div",{staticClass:"break-words font-bold max-w-xs mb-4 text-xl"},[e._v(e._s(e.title))]):e._e(),e.message?t("div",{staticClass:"break-words leading-5 max-w-xs mb-6 opacity-60 text-base text-center text-dark-message"},[e._v(" "+e._s(e.message)+" ")]):e._e(),t("primary-button",{staticClass:"mt-2",attrs:{title:e.action},on:{click:e.runActionAndClose}})],1)])])},n=[],o=s(25778),a={name:"AlertDialog",components:{PrimaryButton:o.Z},props:{icon:{default:"",type:String}},data(){return{action:"",callback:null,message:"",showing:!1,title:""}},methods:{async runActionAndClose(){this.callback&&await this.callback(),this.showing=!1},show(e,t,s,i){this.title=e,this.message=t,this.showing=!0,this.action=s||this.$t("general.dismiss"),this.callback=i}}},r=a,l=s(1001),c=(0,l.Z)(r,i,n,!1,null,"6503e9d2",null),d=c.exports},210:function(e,t,s){s.d(t,{Z:function(){return c}});s(57658);var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"active:brightness-75 flex flex-row h-14 items-center px-4 py-2",on:{click:function(t){e.to?e.$router.push(e.to):e.$emit("click")}}},[t("div",{staticClass:"mr-4 w-4"},[e.icon?t("img",{staticClass:"me-4 text-2xl text-primary-100",attrs:{src:e.icon}}):e._e()]),t("div",[t("div",[e._v(e._s(e.title))]),e.subtitle?t("div",{staticClass:"text-xs",class:e.subtitleClass},[e._v(e._s(e.subtitle))]):e._e()]),t("div",{attrs:{ckass:"flex-grow"}}),e.loading?t("i",{staticClass:"animate-spin icon-spinner"}):e.appendIcon?t("i",{staticClass:"se-4 text-2xl text-primary-100",class:e.appendIcon}):e._e()])},n=[],o={name:"ListItem",components:{},props:{appendIcon:{default:"",type:String},icon:{default:"",type:String},loading:{type:Boolean},subtitle:{default:"",type:String},subtitleClass:{default:"",type:String},title:{default:"",type:String},to:{default:"",type:String}}},a=o,r=s(1001),l=(0,r.Z)(a,i,n,!1,null,null,null),c=l.exports},92266:function(e,t,s){s.d(t,{Z:function(){return w}});var i=function(){var e=this,t=e._self._c;e._self._setupProxy;return t("div",{staticClass:"bg-contain bg-no-repeat relative rounded-full",class:[{[e.bgIconClass]:!e.icon&&!e.iconUri||e.error}]},[e.showNonVerifiedStatus&&!e.verified?t("img",{staticClass:"absolute",class:[e.nonVerifiedTokenIconClasses],attrs:{src:s(37652)},on:{mouseout:function(t){return e.$emit("hideUnverifiedTokenPopover")},mouseover:function(t){return e.$emit("showUnverifiedTokenPopover",t)}}}):e._e(),e.displayChainBadge?t("img",{staticClass:"-bottom-1 -right-1 absolute border-2 border-dark-N16 h-5 rounded-full w-5",attrs:{src:e.chainLogo},on:{mouseover:e.showChainTokenPopover}}):e._e(),e.displayChainBadge?t("chain-token-popover",{ref:"chainTokenPopover",attrs:{chain:e.chain,"popover-position":"left-[86px]"}}):e._e(),e.checked?t("div",{staticClass:"-ml-[1.5px] -mt-0.5 absolute bg-black bg-opacity-80 border-2 border-brand-primary h-9 rounded-full w-9"},[t("img",{staticClass:"h-4 mt-2 mx-auto w-4",attrs:{src:s(65035)}})]):e._e(),e.error?e._e():t("img",{staticClass:"h-full object-contain rounded-full w-full",class:{"bg-white":e.loaded&&!e.error},attrs:{src:e.icon||e.iconUri},on:{error:function(t){e.error=!0},load:function(t){e.loaded=!0}}})],1)},n=[],o=s(79317),a=function(){var e=this,t=e._self._c;e._self._setupProxy;return t("Transition",{attrs:{name:"slide"}},[t("simple-popover",{ref:"popover",staticClass:"fixed t-chain_token_popover text-sm w-0 z-10",class:[e.popoverPosition],attrs:{"background-class":"bg-dark-N04",caret:!1,"caret-horizontal-position":"",padding:"p-0"}},[t("chain-badge",{staticClass:"h-6 text-xs w-max",attrs:{chain:e.chain}})],1)],1)},r=[],l=s(43130),c=s(18135),d=s(20144),h=d.ZP.extend({name:"ChainTokenPopover",components:{ChainBadge:l.Z,SimplePopover:c.Z},props:{chain:{default:void 0,type:Object},popoverPosition:{required:!0,type:String}},computed:{popover(){return this.$refs.popover}},methods:{show(e){this.popover.show(),this.$nextTick((()=>{const t=this.popover.$el,s=t.offsetHeight+e.offsetY;t.style.top=e.pageY-s+20+"px"}))}}}),u=h,f=s(1001),p=(0,f.Z)(u,a,r,!1,null,"5b9d2111",null),g=p.exports,m=s(13692),v=s(13212),b=s(37426),k=d.ZP.extend({name:"TokenIcon",components:{ChainTokenPopover:g},props:{address:{default:"",type:String},chain:{default:void 0,type:Object},checked:{default:!1,type:Boolean},iconUri:{default:"",type:String},nonVerifiedTokenIconClasses:{default:"-left-2.5 h-5 top-2 w-5",type:String},showChainInfo:{default:!1,type:Boolean},type:{default:"",type:String}},data(){return{error:!1,loaded:!1,token:void 0}},computed:{bgIconClass(){let e="bg-generic-token";return this.showNonVerifiedStatus&&!this.verified&&(e="bg-generic-token-unverified"),`${e} bg-dark-N16`},chainLogo(){return this.chain?(0,m.Z)(this.chain).icon():""},chainTokenPopover(){return this.$refs.chainTokenPopover},displayChainBadge(){return!!this.token&&(this.showChainInfo&&!b.Z.isNativeToken(this.token))},icon(){const e=v["default"].isNftType(this.type);return this.error||!this.chain||e?"":(0,m.Z)(this.chain).tokenIconUrl(this.address)},showNonVerifiedStatus(){const e=["Overview","WatchListSettings"],t=e.includes(this.$route.name),s="undefined"!==typeof this.token;return!t&&s},verified(){return!this.showNonVerifiedStatus||b.Z.isTokenVerified(this.token)}},watch:{address(){this.error=!1,this.loaded=!1}},mounted(){this.address&&this.chain&&(this.token=this.$store.getters.getTokenViaSerializedKey(this.address,this.chain,o.oZ.ALL))},methods:{showChainTokenPopover(e){this.chainTokenPopover.show(e)}}}),x=k,y=(0,f.Z)(x,i,n,!1,null,"8c61503c",null),w=y.exports},43130:function(e,t,s){s.d(t,{Z:function(){return d}});var i=function(){var e=this,t=e._self._c;return e.chainNameFriendly?t("div",{staticClass:"flex items-center justify-center px-2 py-0.5 rounded-full space-x-1 t-chain-badge text-center text-dark-N77 truncate",class:[e.backgroundColor]},[e.chainLogo?t("img",{staticClass:"border-2 border-dark-N16 h-5 object-contain rounded-full w-5",attrs:{alt:"",src:e.chainLogo}}):e._e(),t("div",{staticClass:"t-chain-badge-name"},[e._v(e._s(e.chainNameFriendly))])]):e._e()},n=[],o=s(13692),a={name:"ChainBadge",props:{backgroundColor:{default:"bg-dark-N16",type:String},chain:{default:void 0,type:Object}},computed:{chainLogo(){if(this.chain)return(0,o.Z)(this.chain).icon()},chainNameFriendly(){if(this.chain)return this.$store.getters.chainNameFriendly(this.chain)}}},r=a,l=s(1001),c=(0,l.Z)(r,i,n,!1,null,null,null),d=c.exports},82403:function(e,t,s){s.d(t,{Z:function(){return c}});var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"flex items-center justify-center relative"},[t("input",{staticClass:"absolute appearance-none bg-white block border-4 h-6 rounded-full toggle-checkbox w-6",class:e.disabled?"cursor-not-allowed":"cursor-pointer",attrs:{name:"toggle",type:"checkbox"},domProps:{checked:e.checked}}),t("label",{staticClass:"flex h-6 relative select-none w-12",class:e.disabled?"cursor-not-allowed":"cursor-pointer",attrs:{for:"toggle"}},[t("span",{staticClass:"absolute h-full left-0 rounded-full top-0 w-full",class:{"bg-accent":e.checked,"bg-dark-N20":!e.checked}}),t("span",{staticClass:"absolute bg-white border-2 duration-300 ease-in-out flex h-6 items-center justify-center rounded-full transition-transform w-6",class:{"right-0":e.checked,"border-accent":e.checked,"border-dark-N20":!e.checked}})])])},n=[],o={name:"OperaToggle",props:{checked:{default:!1,type:Boolean},disabled:{default:!1,type:Boolean}}},a=o,r=s(1001),l=(0,r.Z)(a,i,n,!1,null,null,null),c=l.exports},58448:function(e,t,s){s.d(t,{Z:function(){return c}});var i=function(){var e=this,t=e._self._c;return t("div",[t("transition",{attrs:{name:"fade"}},[e.showing?t("div",{staticClass:"bg-black bottom-0 fade fixed left-0 opacity-60 px-4 right-0 top-0 z-50",on:{click:e.close}}):e._e()]),t("transition",{attrs:{name:"slide"}},[e.showing?t("div",{staticClass:"-translate-x-1/2 bg-modal bottom-0 fixed left-1/2 max-h-screen max-w-screen-sm overflow-y-scroll p-4 rounded-t-3xl w-screen z-50"},[e._t("default")],2):e._e()])],1)},n=[],o={name:"BottomSheet",data(){return{showing:!1}},methods:{close(){this.$emit("close"),this.showing=!1},show(){this.showing=!0}}},a=o,r=s(1001),l=(0,r.Z)(a,i,n,!1,null,"70f89c6e",null),c=l.exports},16701:function(e,t,s){s.d(t,{Z:function(){return h}});var i=function(){var e=this,t=e._self._c;return t("bottom-sheet",{ref:"sheet"},[t("div",[e.title?t("div",{staticClass:"font-bold mb-2 text-xl"},[e._v(" "+e._s(e.title)+" ")]):e._e(),e._l(e.items,(function(s){return t("div",{key:s.key,on:{click:function(t){return e.itemClicked(s.key)}}},["listItem"===s.type?t("list-item",{staticClass:"-mx-4",attrs:{"append-icon":s.appendIcon,icon:s.icon,loading:s.loading,subtitle:s.subtitle,"subtitle-class":s.subtitleClass,title:s.title},on:{click:function(t){return e.itemClicked(s.key)}}}):e._e(),"divider"===s.type?t("div",{staticClass:"border-positive-10 border-t my-2"}):e._e()],1)}))],2)])},n=[],o=s(58448),a=s(210),r={name:"ListSheet",components:{BottomSheet:o.Z,ListItem:a.Z},data(){return{action:null,items:null,onItemClicked:null,title:null}},methods:{itemClicked(e){this.onItemClicked&&this.onItemClicked(e),this.$refs.sheet.close()},show(e,t=[],s,i){this.title=e,this.items=t,this.onItemClicked=s,this.action=i,this.$refs.sheet.show()}}},l=r,c=s(1001),d=(0,c.Z)(l,i,n,!1,null,null,null),h=d.exports},4800:function(e,t,s){s.r(t),s.d(t,{default:function(){return y}});var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"flex flex-col"},[t("top-bar",{attrs:{"back-override":e.backOverride,title:e.$t("general.fioHandle")}}),t("div",{staticClass:"flex flex-col flex-grow items-center px-8 py-8"},[t("div",{staticClass:"bg-n3 flex flex-row items-center p-4 rounded-lg w-full"},[t("img",{staticClass:"h-10 w-10",attrs:{src:s(81741)}}),t("div",{staticClass:"font-bold ms-2 text-center text-emphasis-high text-md"},[e._v(" "+e._s(e.handle)+" ")]),t("div",{staticClass:"flex-grow"})]),t("div",{staticClass:"flex flex-col mt-4 w-full",class:{"pointer-events-none animate-pulse":e.isLoading}},e._l(e.connections,(function(s,i){return t("div",{key:s.symbol,staticClass:"bg-n2 cursor-pointer flex items-center justify-between mb-2 px-4 py-3 rounded-lg",on:{click:function(t){return e.toggle(i)}}},[t("token-icon",{staticClass:"h-10 object-contain rounded-full w-10",attrs:{address:e.nullAddress,chain:e.connection2chain(s)}}),t("div",{staticClass:"flex-1 mx-4"},[t("div",[e._v(e._s(s.name))]),t("div",{staticClass:"text-emphasis-medium text-xs"},[e._v(e._s(i))])]),t("opera-toggle",{class:`t-fio-${i}-switch`,attrs:{checked:e.checked(i)}})],1)})),0),t("alert-dialog",{ref:"errorDialog"}),t("list-sheet",{ref:"handleSheet"}),t("div",{staticClass:"flex-grow"}),t("div",{staticClass:"mt-5"},[t("div",{staticClass:"flex-col p-4"},[t("div",{staticClass:"font-bold leading-5 mb-8 mx-8 text-dark-N77 text-sm",class:{"opacity-0":!e.changes.dirty}},[e._v(" "+e._s(e.$t("fio.changesNeedConfirmation"))+" ")]),t("primary-button",{staticClass:"flex-1 w-full",attrs:{disabled:!e.changes.dirty,loading:e.isLoading,title:e.$t("general.save")},on:{click:e.save}})],1)])],1)],1)},n=[],o=(s(57658),s(84924)),a=s(47812),r=s(66229),l=s(90881),c=s(16701),d=s(82403),h=s(25778),u=s(69790),f=s(92266),p=s(69986),g=s(88498),m=s(25108),v={name:"FioConnect",components:{AlertDialog:l.Z,ListSheet:c.Z,OperaToggle:d.Z,PrimaryButton:h.Z,TokenIcon:f.Z,TopBar:p.Z},data(){return{backOverride:this.$route.params?.backOverride,connections:o.T_,handle:"",handles:[],nullAddress:a.L1,selected:{}}},computed:{changes(){const{selected:e}=this,t=this.original(),s=Object.values(t).filter((t=>!e[t.chainCode])),i=Object.values(e).filter((e=>!t[e.chainCode]));return{additions:i,dirty:s.length||i.length,removals:s}},connectable(){const e=this.$store.getters.fioConnectableAddresses,t={};if(e?.length)for(const s of e)t[s.chainCode]=s;return t},connection2chain(){return e=>(0,r.aP)(e.chainUId)},isLoading(){return this.$store.getters.isLoading("fio")}},watch:{handle:{handler(e){this.fetchAllPublicAddressesByHandle(e)}}},async mounted(){u.Z.sendStatsEvent(u.Z.types.IMPRESSION,"wt_setting_fio"),this.handle=this.$route.query.handle,await this.$store.dispatch("getFioConnectableAddresses"),await this.$store.dispatch("fetchFioHandles")},methods:{checked(e){return!!this.selected[e]},async fetchAllPublicAddressesByHandle(e){await this.$store.dispatch("fetchAllPublicAddressesByHandle",e),this.selected={...this.original()}},original(){const{connectable:e}=this,t=this.$store.getters.allPublicAddressesByHandle(this.handle),s={};if(t.length)for(const i of t)s[i.chain_code]={address:i.public_address||e[i.chain_code]?.address,chainCode:i.chain_code};return s},async save(){await this.untilLoaded(),this.$store.commit("START_LOADING",{fio:"addressLedgerUpdate"}),this.$authenticator.lockAuthenticatorWithPassword();try{this.changes.additions.length>0&&await g.Z.fioAddAddresses(this.$store.getters.fioPublicKey,this.handle,this.changes.additions),this.changes.removals.length>0&&await g.Z.fioRemoveAddresses(this.$store.getters.fioPublicKey,this.handle,this.changes.removals)}catch(e){m.error("ERROR SAVING FIO CHANGES",e),this.$errorReporter.reportError(e)}this.$authenticator.clearSecretAndUnlockAuthenticator(),await this.fetchAllPublicAddressesByHandle(this.handle),this.$store.commit("FINISH_LOADING",{fio:"addressLedgerUpdate"})},showErrorDialog(){this.$refs.errorDialog.show(this.$t("errors.generic.oops"),this.$t("errors.generic.somethingWentWrong"),null,(()=>this.$router.replace("/settings")))},showHandleSheet(){if(this.isLoading)return;const e=this.$store.getters.fioHandles,t=e.map((e=>({appendIcon:this.handle===e?"icon-checkmark":null,key:e,title:e,type:"listItem"})));t.push({type:"divider"}),t.push({icon:"icon-plus",key:"action",title:this.$t("fio.register.createHandle"),type:"listItem"}),this.$refs.handleSheet.show(this.$t("fio.chooseActiveHandle"),t,(t=>{"action"===t?this.$router.push({name:"FioRegister",query:{hasOperaDomain:e.some((e=>e.endsWith("@opera"))).toString()}}):this.handle=t}))},async toggle(e){const t=this.selected[e];t?this.$delete(this.selected,e):this.$set(this.selected,e,{address:this.connectable[e].address,chainCode:e})},untilLoaded(){const e=t=>{this.isLoading?setTimeout((()=>e(t)),100):t()};return new Promise((t=>{e(t)}))}}},b=v,k=s(1001),x=(0,k.Z)(b,i,n,!1,null,null,null),y=x.exports},65035:function(e,t,s){e.exports=s.p+"img/check_selected.1169a7e5.svg"},81741:function(e,t,s){e.exports=s.p+"img/fio.82458516.svg"},37652:function(e,t,s){e.exports=s.p+"img/unverified.3e563384.svg"}}]);