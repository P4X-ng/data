"use strict";(self["webpackChunkdesktop_wallet"]=self["webpackChunkdesktop_wallet"]||[]).push([[1811],{92266:function(t,e,r){r.d(e,{Z:function(){return w}});var s=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"bg-contain bg-no-repeat relative rounded-full",class:[{[t.bgIconClass]:!t.icon&&!t.iconUri||t.error}]},[t.showNonVerifiedStatus&&!t.verified?e("img",{staticClass:"absolute",class:[t.nonVerifiedTokenIconClasses],attrs:{src:r(37652)},on:{mouseout:function(e){return t.$emit("hideUnverifiedTokenPopover")},mouseover:function(e){return t.$emit("showUnverifiedTokenPopover",e)}}}):t._e(),t.displayChainBadge?e("img",{staticClass:"-bottom-1 -right-1 absolute border-2 border-dark-N16 h-5 rounded-full w-5",attrs:{src:t.chainLogo},on:{mouseover:t.showChainTokenPopover}}):t._e(),t.displayChainBadge?e("chain-token-popover",{ref:"chainTokenPopover",attrs:{chain:t.chain,"popover-position":"left-[86px]"}}):t._e(),t.checked?e("div",{staticClass:"-ml-[1.5px] -mt-0.5 absolute bg-black bg-opacity-80 border-2 border-brand-primary h-9 rounded-full w-9"},[e("img",{staticClass:"h-4 mt-2 mx-auto w-4",attrs:{src:r(65035)}})]):t._e(),t.error?t._e():e("img",{staticClass:"h-full object-contain rounded-full w-full",class:{"bg-white":t.loaded&&!t.error},attrs:{src:t.icon||t.iconUri},on:{error:function(e){t.error=!0},load:function(e){t.loaded=!0}}})],1)},i=[],o=r(79317),n=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("Transition",{attrs:{name:"slide"}},[e("simple-popover",{ref:"popover",staticClass:"fixed t-chain_token_popover text-sm w-0 z-10",class:[t.popoverPosition],attrs:{"background-class":"bg-dark-N04",caret:!1,"caret-horizontal-position":"",padding:"p-0"}},[e("chain-badge",{staticClass:"h-6 text-xs w-max",attrs:{chain:t.chain}})],1)],1)},a=[],c=r(43130),l=r(18135),d=r(20144),h=d.ZP.extend({name:"ChainTokenPopover",components:{ChainBadge:c.Z,SimplePopover:l.Z},props:{chain:{default:void 0,type:Object},popoverPosition:{required:!0,type:String}},computed:{popover(){return this.$refs.popover}},methods:{show(t){this.popover.show(),this.$nextTick((()=>{const e=this.popover.$el,r=e.offsetHeight+t.offsetY;e.style.top=t.pageY-r+20+"px"}))}}}),u=h,p=r(1001),f=(0,p.Z)(u,n,a,!1,null,"5b9d2111",null),m=f.exports,v=r(13692),g=r(13212),y=r(37426),k=d.ZP.extend({name:"TokenIcon",components:{ChainTokenPopover:m},props:{address:{default:"",type:String},chain:{default:void 0,type:Object},checked:{default:!1,type:Boolean},iconUri:{default:"",type:String},nonVerifiedTokenIconClasses:{default:"-left-2.5 h-5 top-2 w-5",type:String},showChainInfo:{default:!1,type:Boolean},type:{default:"",type:String}},data(){return{error:!1,loaded:!1,token:void 0}},computed:{bgIconClass(){let t="bg-generic-token";return this.showNonVerifiedStatus&&!this.verified&&(t="bg-generic-token-unverified"),`${t} bg-dark-N16`},chainLogo(){return this.chain?(0,v.Z)(this.chain).icon():""},chainTokenPopover(){return this.$refs.chainTokenPopover},displayChainBadge(){return!!this.token&&(this.showChainInfo&&!y.Z.isNativeToken(this.token))},icon(){const t=g["default"].isNftType(this.type);return this.error||!this.chain||t?"":(0,v.Z)(this.chain).tokenIconUrl(this.address)},showNonVerifiedStatus(){const t=["Overview","WatchListSettings"],e=t.includes(this.$route.name),r="undefined"!==typeof this.token;return!e&&r},verified(){return!this.showNonVerifiedStatus||y.Z.isTokenVerified(this.token)}},watch:{address(){this.error=!1,this.loaded=!1}},mounted(){this.address&&this.chain&&(this.token=this.$store.getters.getTokenViaSerializedKey(this.address,this.chain,o.oZ.ALL))},methods:{showChainTokenPopover(t){this.chainTokenPopover.show(t)}}}),b=k,x=(0,p.Z)(b,s,i,!1,null,"8c61503c",null),w=x.exports},43130:function(t,e,r){r.d(e,{Z:function(){return d}});var s=function(){var t=this,e=t._self._c;return t.chainNameFriendly?e("div",{staticClass:"flex items-center justify-center px-2 py-0.5 rounded-full space-x-1 t-chain-badge text-center text-dark-N77 truncate",class:[t.backgroundColor]},[t.chainLogo?e("img",{staticClass:"border-2 border-dark-N16 h-5 object-contain rounded-full w-5",attrs:{alt:"",src:t.chainLogo}}):t._e(),e("div",{staticClass:"t-chain-badge-name"},[t._v(t._s(t.chainNameFriendly))])]):t._e()},i=[],o=r(13692),n={name:"ChainBadge",props:{backgroundColor:{default:"bg-dark-N16",type:String},chain:{default:void 0,type:Object}},computed:{chainLogo(){if(this.chain)return(0,o.Z)(this.chain).icon()},chainNameFriendly(){if(this.chain)return this.$store.getters.chainNameFriendly(this.chain)}}},a=n,c=r(1001),l=(0,c.Z)(a,s,i,!1,null,null,null),d=l.exports},71811:function(t,e,r){r.r(e),r.d(e,{default:function(){return y}});var s=function(){var t=this,e=t._self._c;return e("div",[e("top-bar",{attrs:{"test-parent-name":"approve_confirm",title:t.$t("general.confirmation")}}),e("div",{staticClass:"px-4 py-4"},[e("div",{staticClass:"flex flex-col items-center justify-center mx-10"},[e("div",{staticClass:"flex flex-row items-center justify-center"},[e("token-icon",{staticClass:"h-10 my-2 w-10",attrs:{address:t.toAddress,chain:t.chain,"icon-uri":t.token.token.iconURI}})],1),e("div",{staticClass:"flex flex-col items-center justify-center"},[e("div",{staticClass:"font-bold py-4 text-2xl text-center"},[e("i18n",{attrs:{path:"views.approveConfirm.allowToSpend",tag:"p"},scopedSlots:t._u([{key:"symbol",fn:function(){return[e("span",[t._v(t._s(t.symbol))])]},proxy:!0},{key:"swapProvider",fn:function(){return[e("span",[t._v(t._s(t.swapProvider))])]},proxy:!0}])})],1),e("div",{staticClass:"py-4"},[e("i18n",{attrs:{path:"views.approveConfirm.allowToWithdraw",tag:"p"},scopedSlots:t._u([{key:"symbol",fn:function(){return[e("span",[t._v(t._s(t.symbol))])]},proxy:!0},{key:"swapProviderLink",fn:function(){return[e("span",[t._v(t._s(t.swapProvider))])]},proxy:!0}])})],1)]),e("div",{staticClass:"bg-brand-primary border-b border-opacity-10 w-full"}),e("div",{staticClass:"flex items-center py-4 w-full"},[t._m(0),t.tx&&null!==t.fee?e("div",{staticClass:"ms-4 w-full"},[e("div",{staticClass:"font-bold mb-1"},[t._v(t._s(t.$t("general.transactionFee")))]),e("div",{staticClass:"text-sm",class:[{"text-spectrum-red":t.insufficientFunds}]},[t._v(" "+t._s(t.transactionFee)+" ")])]):t._e()]),t.isFeeZero?e("div",{staticClass:"text-spectrum-red"},[t._v(" "+t._s(t.$t("errors.cannotEstimateGas"))+" ")]):t._e(),t.error?e("div",{staticClass:"flex justify-center my-5 text-center text-sm text-spectrum-red"},[e("img",{staticClass:"mx-2",attrs:{alt:"",src:r(98498)}}),e("span",[t._v(t._s(t.error))])]):t._e(),e("div",{staticClass:"flex gap-4 justify-around w-full"},[e("outlined-button",{staticClass:"mt-8 t-approve_confirm-reject w-1/2",attrs:{disabled:t.loading,loading:t.loading,title:t.$t("general.reject")},on:{click:t.back}}),e("primary-button",{staticClass:"mt-8 t-approve_confirm-approve w-1/2",attrs:{disabled:t.loading||!t.tx||!!t.error,loading:t.loading,title:t.$t("general.approve")},on:{click:t.approveTx}})],1)])])],1)},i=[function(){var t=this,e=t._self._c;return e("span",{staticClass:"icon-wrapper text-brand-primary"},[e("i",{staticClass:"icon-currency info-icon",staticStyle:{"font-size":"32px"}})])}],o=r(66229),n=r(70794),a=r(9906),c=r(25778),l=r(92266),d=r(69986),h=r(10359),u=r(37426),p=r(25108),f={name:"ApproveConfirm",components:{OutlinedButton:a.Z,PrimaryButton:c.Z,TokenIcon:l.Z,TopBar:d.Z},props:{approve:{default:void 0,type:Object},contract:{default:void 0,type:Object},token:{default:void 0,type:Object}},data(){return{error:null,fee:null,loading:!1,success:!1,tx:null}},computed:{chain(){return this.token.token.chain},contractName(){return this.contract.name},feeFiat(){if(!this.fee)return;const t=this.$store.getters.matchingNativeToken("",this.chain),e=this.getPriceForToken(t);return this.formatNumber(this.fee).multipliedBy(new n.Z(e))},feeSymbol(){const t=this.$store.getters.matchingNativeToken("",this.chain);return t?t.contract.symbol.toUpperCase():""},insufficientFunds(){return this.$store.getters.txError.insufficientFunds},isFeeZero(){if(null!==this.fee)return this.fee.isEqualTo(0)},swapProvider(){return this.$store.getters.aggregatorName},symbol(){return this.token.token.symbol},toAddress(){return this.approve.to},transactionFee(){if(!this.tx)return;const[t,e]=[this.formatNumber(this.fee),this.localizeCurrency(this.feeFiat)];return`~ ${t} ${this.feeSymbol} (${e})`}},watch:{insufficientFunds(t){t&&(this.error=this.$t("errors.generic.insufficientFunds"))}},async mounted(){await this.setupTx(),this.setSwapTxFee()},methods:{async approveTx(){this.loading=!0;try{const t=await this.$wallet.confirmTransaction(this.tx.txId);await this.$store.dispatch("setPendingApproval",Object.assign({timeStamp:Date.now(),token:this.token.token,txHash:t})),this.back()}catch(t){this.$store.getters.authAborted||(this.error=this.getErrorMessage(t),this.$errorReporter.reportError(t))}this.loading=!1},back(){this.$router.back()},formatNumber:h.Z.formatNumber,getErrorMessage(t){p.error(t),this.error=this.$t("errors.generic.unknownError")},getPriceForToken(t){return t?this.$store.getters.getPriceForToken(t):0},isTransactionFeeCovered(t){const{symbol:e}=this,r={amount:this.approve.value,chain:this.chain,fee:t,symbol:e};return this.$store.getters.isTransactionFeeCovered(r)},localizeCurrency:h.Z.localizeCurrency,setSwapTxFee(){const t=this.tx.token;this.fee=u.Z.withDecimals(t.amount,t.decimals),this.isTransactionFeeCovered(this.fee)||this.$store.dispatch("setTxError","insufficientFunds")},async setupTx(){this.loading=!0;try{const t=this.approve,e=(0,o.wL)(t);this.tx=await this.$wallet.createSwapTransaction(e)}catch(t){this.error=this.getErrorMessage(t),this.$errorReporter.reportError(t)}this.loading=!1}}},m=f,v=r(1001),g=(0,v.Z)(m,s,i,!1,null,null,null),y=g.exports},65035:function(t,e,r){t.exports=r.p+"img/check_selected.1169a7e5.svg"},37652:function(t,e,r){t.exports=r.p+"img/unverified.3e563384.svg"}}]);