00000000: 2f2a 0a43 6f70 7972 6967 6874 2032 3031  /*.Copyright 201
00000010: 3920 5468 6520 4b75 6265 726e 6574 6573  9 The Kubernetes
00000020: 2041 7574 686f 7273 2e0a 0a4c 6963 656e   Authors...Licen
00000030: 7365 6420 756e 6465 7220 7468 6520 4170  sed under the Ap
00000040: 6163 6865 204c 6963 656e 7365 2c20 5665  ache License, Ve
00000050: 7273 696f 6e20 322e 3020 2874 6865 2022  rsion 2.0 (the "
00000060: 4c69 6365 6e73 6522 293b 0a79 6f75 206d  License");.you m
00000070: 6179 206e 6f74 2075 7365 2074 6869 7320  ay not use this 
00000080: 6669 6c65 2065 7863 6570 7420 696e 2063  file except in c
00000090: 6f6d 706c 6961 6e63 6520 7769 7468 2074  ompliance with t
000000a0: 6865 204c 6963 656e 7365 2e0a 596f 7520  he License..You 
000000b0: 6d61 7920 6f62 7461 696e 2061 2063 6f70  may obtain a cop
000000c0: 7920 6f66 2074 6865 204c 6963 656e 7365  y of the License
000000d0: 2061 740a 0a20 2020 2068 7474 703a 2f2f   at..    http://
000000e0: 7777 772e 6170 6163 6865 2e6f 7267 2f6c  www.apache.org/l
000000f0: 6963 656e 7365 732f 4c49 4345 4e53 452d  icenses/LICENSE-
00000100: 322e 300a 0a55 6e6c 6573 7320 7265 7175  2.0..Unless requ
00000110: 6972 6564 2062 7920 6170 706c 6963 6162  ired by applicab
00000120: 6c65 206c 6177 206f 7220 6167 7265 6564  le law or agreed
00000130: 2074 6f20 696e 2077 7269 7469 6e67 2c20   to in writing, 
00000140: 736f 6674 7761 7265 0a64 6973 7472 6962  software.distrib
00000150: 7574 6564 2075 6e64 6572 2074 6865 204c  uted under the L
00000160: 6963 656e 7365 2069 7320 6469 7374 7269  icense is distri
00000170: 6275 7465 6420 6f6e 2061 6e20 2241 5320  buted on an "AS 
00000180: 4953 2220 4241 5349 532c 0a57 4954 484f  IS" BASIS,.WITHO
00000190: 5554 2057 4152 5241 4e54 4945 5320 4f52  UT WARRANTIES OR
000001a0: 2043 4f4e 4449 5449 4f4e 5320 4f46 2041   CONDITIONS OF A
000001b0: 4e59 204b 494e 442c 2065 6974 6865 7220  NY KIND, either 
000001c0: 6578 7072 6573 7320 6f72 2069 6d70 6c69  express or impli
000001d0: 6564 2e0a 5365 6520 7468 6520 4c69 6365  ed..See the Lice
000001e0: 6e73 6520 666f 7220 7468 6520 7370 6563  nse for the spec
000001f0: 6966 6963 206c 616e 6775 6167 6520 676f  ific language go
00000200: 7665 726e 696e 6720 7065 726d 6973 7369  verning permissi
00000210: 6f6e 7320 616e 640a 6c69 6d69 7461 7469  ons and.limitati
00000220: 6f6e 7320 756e 6465 7220 7468 6520 4c69  ons under the Li
00000230: 6365 6e73 652e 0a2a 2f0a 0a70 6163 6b61  cense..*/..packa
00000240: 6765 2064 796e 616d 6963 6365 7274 6966  ge dynamiccertif
00000250: 6963 6174 6573 0a0a 696d 706f 7274 2028  icates..import (
00000260: 0a09 2274 6573 7469 6e67 220a 290a 0a66  .."testing".)..f
00000270: 756e 6320 5465 7374 4365 7274 4b65 7943  unc TestCertKeyC
00000280: 6f6e 7465 6e74 4571 7561 6c73 2874 202a  ontentEquals(t *
00000290: 7465 7374 696e 672e 5429 207b 0a09 7465  testing.T) {..te
000002a0: 7374 7320 3a3d 205b 5d73 7472 7563 7420  sts := []struct 
000002b0: 7b0a 0909 6e61 6d65 2020 2020 2073 7472  {...name     str
000002c0: 696e 670a 0909 6c68 7320 2020 2020 202a  ing...lhs      *
000002d0: 6365 7274 4b65 7943 6f6e 7465 6e74 0a09  certKeyContent..
000002e0: 0972 6873 2020 2020 2020 2a63 6572 744b  .rhs      *certK
000002f0: 6579 436f 6e74 656e 740a 0909 6578 7065  eyContent...expe
00000300: 6374 6564 2062 6f6f 6c0a 097d 7b0a 0909  cted bool..}{...
00000310: 7b0a 0909 096e 616d 653a 2020 2020 2022  {....name:     "
00000320: 626f 7468 206e 696c 222c 0a09 0909 6578  both nil",....ex
00000330: 7065 6374 6564 3a20 7472 7565 2c0a 0909  pected: true,...
00000340: 7d2c 0a09 097b 0a09 0909 6e61 6d65 3a20  },...{....name: 
00000350: 2020 2020 226c 6873 206e 696c 222c 0a09      "lhs nil",..
00000360: 0909 7268 733a 2020 2020 2020 2663 6572  ..rhs:      &cer
00000370: 744b 6579 436f 6e74 656e 747b 7d2c 0a09  tKeyContent{},..
00000380: 0909 6578 7065 6374 6564 3a20 6661 6c73  ..expected: fals
00000390: 652c 0a09 097d 2c0a 0909 7b0a 0909 096e  e,...},...{....n
000003a0: 616d 653a 2020 2020 2022 7268 7320 6e69  ame:     "rhs ni
000003b0: 6c22 2c0a 0909 096c 6873 3a20 2020 2020  l",....lhs:     
000003c0: 2026 6365 7274 4b65 7943 6f6e 7465 6e74   &certKeyContent
000003d0: 7b7d 2c0a 0909 0965 7870 6563 7465 643a  {},....expected:
000003e0: 2066 616c 7365 2c0a 0909 7d2c 0a09 097b   false,...},...{
000003f0: 0a09 0909 6e61 6d65 3a20 2020 2020 2273  ....name:     "s
00000400: 616d 6522 2c0a 0909 096c 6873 3a20 2020  ame",....lhs:   
00000410: 2020 2026 6365 7274 4b65 7943 6f6e 7465     &certKeyConte
00000420: 6e74 7b63 6572 743a 205b 5d62 7974 6528  nt{cert: []byte(
00000430: 2266 6f6f 2229 2c20 6b65 793a 205b 5d62  "foo"), key: []b
00000440: 7974 6528 2262 617a 2229 7d2c 0a09 0909  yte("baz")},....
00000450: 7268 733a 2020 2020 2020 2663 6572 744b  rhs:      &certK
00000460: 6579 436f 6e74 656e 747b 6365 7274 3a20  eyContent{cert: 
00000470: 5b5d 6279 7465 2822 666f 6f22 292c 206b  []byte("foo"), k
00000480: 6579 3a20 5b5d 6279 7465 2822 6261 7a22  ey: []byte("baz"
00000490: 297d 2c0a 0909 0965 7870 6563 7465 643a  )},....expected:
000004a0: 2074 7275 652c 0a09 097d 2c0a 0909 7b0a   true,...},...{.
000004b0: 0909 096e 616d 653a 2020 2020 2022 6469  ...name:     "di
000004c0: 6666 6572 656e 7420 6365 7274 222c 0a09  fferent cert",..
000004d0: 0909 6c68 733a 2020 2020 2020 2663 6572  ..lhs:      &cer
000004e0: 744b 6579 436f 6e74 656e 747b 6365 7274  tKeyContent{cert
000004f0: 3a20 5b5d 6279 7465 2822 666f 6f22 292c  : []byte("foo"),
00000500: 206b 6579 3a20 5b5d 6279 7465 2822 6261   key: []byte("ba
00000510: 7a22 297d 2c0a 0909 0972 6873 3a20 2020  z")},....rhs:   
00000520: 2020 2026 6365 7274 4b65 7943 6f6e 7465     &certKeyConte
00000530: 6e74 7b63 6572 743a 205b 5d62 7974 6528  nt{cert: []byte(
00000540: 2262 6172 2229 2c20 6b65 793a 205b 5d62  "bar"), key: []b
00000550: 7974 6528 2262 617a 2229 7d2c 0a09 0909  yte("baz")},....
00000560: 6578 7065 6374 6564 3a20 6661 6c73 652c  expected: false,
00000570: 0a09 097d 2c0a 0909 7b0a 0909 096e 616d  ...},...{....nam
00000580: 653a 2020 2020 2022 6469 6666 6572 656e  e:     "differen
00000590: 7420 6b65 7922 2c0a 0909 096c 6873 3a20  t key",....lhs: 
000005a0: 2020 2020 2026 6365 7274 4b65 7943 6f6e       &certKeyCon
000005b0: 7465 6e74 7b63 6572 743a 205b 5d62 7974  tent{cert: []byt
000005c0: 6528 2266 6f6f 2229 2c20 6b65 793a 205b  e("foo"), key: [
000005d0: 5d62 7974 6528 2262 617a 2229 7d2c 0a09  ]byte("baz")},..
000005e0: 0909 7268 733a 2020 2020 2020 2663 6572  ..rhs:      &cer
000005f0: 744b 6579 436f 6e74 656e 747b 6365 7274  tKeyContent{cert
00000600: 3a20 5b5d 6279 7465 2822 666f 6f22 292c  : []byte("foo"),
00000610: 206b 6579 3a20 5b5d 6279 7465 2822 7175   key: []byte("qu
00000620: 7822 297d 2c0a 0909 0965 7870 6563 7465  x")},....expecte
00000630: 643a 2066 616c 7365 2c0a 0909 7d2c 0a09  d: false,...},..
00000640: 097b 0a09 0909 6e61 6d65 3a20 2020 2020  .{....name:     
00000650: 2264 6966 6665 7265 6e74 2063 6572 7420  "different cert 
00000660: 616e 6420 6b65 7922 2c0a 0909 096c 6873  and key",....lhs
00000670: 3a20 2020 2020 2026 6365 7274 4b65 7943  :      &certKeyC
00000680: 6f6e 7465 6e74 7b63 6572 743a 205b 5d62  ontent{cert: []b
00000690: 7974 6528 2266 6f6f 2229 2c20 6b65 793a  yte("foo"), key:
000006a0: 205b 5d62 7974 6528 2262 617a 2229 7d2c   []byte("baz")},
000006b0: 0a09 0909 7268 733a 2020 2020 2020 2663  ....rhs:      &c
000006c0: 6572 744b 6579 436f 6e74 656e 747b 6365  ertKeyContent{ce
000006d0: 7274 3a20 5b5d 6279 7465 2822 6261 7222  rt: []byte("bar"
000006e0: 292c 206b 6579 3a20 5b5d 6279 7465 2822  ), key: []byte("
000006f0: 7175 7822 297d 2c0a 0909 0965 7870 6563  qux")},....expec
00000700: 7465 643a 2066 616c 7365 2c0a 0909 7d2c  ted: false,...},
00000710: 0a09 7d0a 0a09 666f 7220 5f2c 2074 6573  ..}...for _, tes
00000720: 7420 3a3d 2072 616e 6765 2074 6573 7473  t := range tests
00000730: 207b 0a09 0974 2e52 756e 2874 6573 742e   {...t.Run(test.
00000740: 6e61 6d65 2c20 6675 6e63 2874 202a 7465  name, func(t *te
00000750: 7374 696e 672e 5429 207b 0a09 0909 6163  sting.T) {....ac
00000760: 7475 616c 203a 3d20 7465 7374 2e6c 6873  tual := test.lhs
00000770: 2e45 7175 616c 2874 6573 742e 7268 7329  .Equal(test.rhs)
00000780: 0a09 0909 6966 2061 6374 7561 6c20 213d  ....if actual !=
00000790: 2074 6573 742e 6578 7065 6374 6564 207b   test.expected {
000007a0: 0a09 0909 0974 2e45 7272 6f72 2861 6374  .....t.Error(act
000007b0: 7561 6c29 0a09 0909 7d0a 0909 7d29 0a09  ual)....}...})..
000007c0: 7d0a 7d0a 0a66 756e 6320 5465 7374 534e  }.}..func TestSN
000007d0: 4943 6572 744b 6579 436f 6e74 656e 7445  ICertKeyContentE
000007e0: 7175 616c 7328 7420 2a74 6573 7469 6e67  quals(t *testing
000007f0: 2e54 2920 7b0a 0974 6573 7473 203a 3d20  .T) {..tests := 
00000800: 5b5d 7374 7275 6374 207b 0a09 096e 616d  []struct {...nam
00000810: 6520 2020 2020 7374 7269 6e67 0a09 096c  e     string...l
00000820: 6873 2020 2020 2020 2a73 6e69 4365 7274  hs      *sniCert
00000830: 4b65 7943 6f6e 7465 6e74 0a09 0972 6873  KeyContent...rhs
00000840: 2020 2020 2020 2a73 6e69 4365 7274 4b65        *sniCertKe
00000850: 7943 6f6e 7465 6e74 0a09 0965 7870 6563  yContent...expec
00000860: 7465 6420 626f 6f6c 0a09 7d7b 0a09 097b  ted bool..}{...{
00000870: 0a09 0909 6e61 6d65 3a20 2020 2020 2262  ....name:     "b
00000880: 6f74 6820 6e69 6c22 2c0a 0909 0965 7870  oth nil",....exp
00000890: 6563 7465 643a 2074 7275 652c 0a09 097d  ected: true,...}
000008a0: 2c0a 0909 7b0a 0909 096e 616d 653a 2020  ,...{....name:  
000008b0: 2020 2022 6c68 7320 6e69 6c22 2c0a 0909     "lhs nil",...
000008c0: 0972 6873 3a20 2020 2020 2026 736e 6943  .rhs:      &sniC
000008d0: 6572 744b 6579 436f 6e74 656e 747b 7d2c  ertKeyContent{},
000008e0: 0a09 0909 6578 7065 6374 6564 3a20 6661  ....expected: fa
000008f0: 6c73 652c 0a09 097d 2c0a 0909 7b0a 0909  lse,...},...{...
00000900: 096e 616d 653a 2020 2020 2022 7268 7320  .name:     "rhs 
00000910: 6e69 6c22 2c0a 0909 096c 6873 3a20 2020  nil",....lhs:   
00000920: 2020 2026 736e 6943 6572 744b 6579 436f     &sniCertKeyCo
00000930: 6e74 656e 747b 7d2c 0a09 0909 6578 7065  ntent{},....expe
00000940: 6374 6564 3a20 6661 6c73 652c 0a09 097d  cted: false,...}
00000950: 2c0a 0909 7b0a 0909 096e 616d 653a 2020  ,...{....name:  
00000960: 2020 2022 7361 6d65 222c 0a09 0909 6c68     "same",....lh
00000970: 733a 2020 2020 2020 2673 6e69 4365 7274  s:      &sniCert
00000980: 4b65 7943 6f6e 7465 6e74 7b63 6572 744b  KeyContent{certK
00000990: 6579 436f 6e74 656e 743a 2063 6572 744b  eyContent: certK
000009a0: 6579 436f 6e74 656e 747b 6365 7274 3a20  eyContent{cert: 
000009b0: 5b5d 6279 7465 2822 666f 6f22 292c 206b  []byte("foo"), k
000009c0: 6579 3a20 5b5d 6279 7465 2822 6261 7a22  ey: []byte("baz"
000009d0: 297d 2c20 736e 694e 616d 6573 3a20 5b5d  )}, sniNames: []
000009e0: 7374 7269 6e67 7b22 6122 7d7d 2c0a 0909  string{"a"}},...
000009f0: 0972 6873 3a20 2020 2020 2026 736e 6943  .rhs:      &sniC
00000a00: 6572 744b 6579 436f 6e74 656e 747b 6365  ertKeyContent{ce
00000a10: 7274 4b65 7943 6f6e 7465 6e74 3a20 6365  rtKeyContent: ce
00000a20: 7274 4b65 7943 6f6e 7465 6e74 7b63 6572  rtKeyContent{cer
00000a30: 743a 205b 5d62 7974 6528 2266 6f6f 2229  t: []byte("foo")
00000a40: 2c20 6b65 793a 205b 5d62 7974 6528 2262  , key: []byte("b
00000a50: 617a 2229 7d2c 2073 6e69 4e61 6d65 733a  az")}, sniNames:
00000a60: 205b 5d73 7472 696e 677b 2261 227d 7d2c   []string{"a"}},
00000a70: 0a09 0909 6578 7065 6374 6564 3a20 7472  ....expected: tr
00000a80: 7565 2c0a 0909 7d2c 0a09 097b 0a09 0909  ue,...},...{....
00000a90: 6e61 6d65 3a20 2020 2020 2264 6966 6665  name:     "diffe
00000aa0: 7265 6e74 2063 6572 7422 2c0a 0909 096c  rent cert",....l
00000ab0: 6873 3a20 2020 2020 2026 736e 6943 6572  hs:      &sniCer
00000ac0: 744b 6579 436f 6e74 656e 747b 6365 7274  tKeyContent{cert
00000ad0: 4b65 7943 6f6e 7465 6e74 3a20 6365 7274  KeyContent: cert
00000ae0: 4b65 7943 6f6e 7465 6e74 7b63 6572 743a  KeyContent{cert:
00000af0: 205b 5d62 7974 6528 2266 6f6f 2229 2c20   []byte("foo"), 
00000b00: 6b65 793a 205b 5d62 7974 6528 2262 617a  key: []byte("baz
00000b10: 2229 7d2c 2073 6e69 4e61 6d65 733a 205b  ")}, sniNames: [
00000b20: 5d73 7472 696e 677b 2261 227d 7d2c 0a09  ]string{"a"}},..
00000b30: 0909 7268 733a 2020 2020 2020 2673 6e69  ..rhs:      &sni
00000b40: 4365 7274 4b65 7943 6f6e 7465 6e74 7b63  CertKeyContent{c
00000b50: 6572 744b 6579 436f 6e74 656e 743a 2063  ertKeyContent: c
00000b60: 6572 744b 6579 436f 6e74 656e 747b 6365  ertKeyContent{ce
00000b70: 7274 3a20 5b5d 6279 7465 2822 6261 7222  rt: []byte("bar"
00000b80: 292c 206b 6579 3a20 5b5d 6279 7465 2822  ), key: []byte("
00000b90: 6261 7a22 297d 2c20 736e 694e 616d 6573  baz")}, sniNames
00000ba0: 3a20 5b5d 7374 7269 6e67 7b22 6122 7d7d  : []string{"a"}}
00000bb0: 2c0a 0909 0965 7870 6563 7465 643a 2066  ,....expected: f
00000bc0: 616c 7365 2c0a 0909 7d2c 0a09 097b 0a09  alse,...},...{..
00000bd0: 0909 6e61 6d65 3a20 2020 2020 2264 6966  ..name:     "dif
00000be0: 6665 7265 6e74 206b 6579 222c 0a09 0909  ferent key",....
00000bf0: 6c68 733a 2020 2020 2020 2673 6e69 4365  lhs:      &sniCe
00000c00: 7274 4b65 7943 6f6e 7465 6e74 7b63 6572  rtKeyContent{cer
00000c10: 744b 6579 436f 6e74 656e 743a 2063 6572  tKeyContent: cer
00000c20: 744b 6579 436f 6e74 656e 747b 6365 7274  tKeyContent{cert
00000c30: 3a20 5b5d 6279 7465 2822 666f 6f22 292c  : []byte("foo"),
00000c40: 206b 6579 3a20 5b5d 6279 7465 2822 6261   key: []byte("ba
00000c50: 7a22 297d 2c20 736e 694e 616d 6573 3a20  z")}, sniNames: 
00000c60: 5b5d 7374 7269 6e67 7b22 6122 7d7d 2c0a  []string{"a"}},.
00000c70: 0909 0972 6873 3a20 2020 2020 2026 736e  ...rhs:      &sn
00000c80: 6943 6572 744b 6579 436f 6e74 656e 747b  iCertKeyContent{
00000c90: 6365 7274 4b65 7943 6f6e 7465 6e74 3a20  certKeyContent: 
00000ca0: 6365 7274 4b65 7943 6f6e 7465 6e74 7b63  certKeyContent{c
00000cb0: 6572 743a 205b 5d62 7974 6528 2266 6f6f  ert: []byte("foo
00000cc0: 2229 2c20 6b65 793a 205b 5d62 7974 6528  "), key: []byte(
00000cd0: 2271 7578 2229 7d2c 2073 6e69 4e61 6d65  "qux")}, sniName
00000ce0: 733a 205b 5d73 7472 696e 677b 2261 227d  s: []string{"a"}
00000cf0: 7d2c 0a09 0909 6578 7065 6374 6564 3a20  },....expected: 
00000d00: 6661 6c73 652c 0a09 097d 2c0a 0909 7b0a  false,...},...{.
00000d10: 0909 096e 616d 653a 2020 2020 2022 6469  ...name:     "di
00000d20: 6666 6572 656e 7420 6365 7274 2061 6e64  fferent cert and
00000d30: 206b 6579 222c 0a09 0909 6c68 733a 2020   key",....lhs:  
00000d40: 2020 2020 2673 6e69 4365 7274 4b65 7943      &sniCertKeyC
00000d50: 6f6e 7465 6e74 7b63 6572 744b 6579 436f  ontent{certKeyCo
00000d60: 6e74 656e 743a 2063 6572 744b 6579 436f  ntent: certKeyCo
00000d70: 6e74 656e 747b 6365 7274 3a20 5b5d 6279  ntent{cert: []by
00000d80: 7465 2822 666f 6f22 292c 206b 6579 3a20  te("foo"), key: 
00000d90: 5b5d 6279 7465 2822 6261 7a22 297d 2c20  []byte("baz")}, 
00000da0: 736e 694e 616d 6573 3a20 5b5d 7374 7269  sniNames: []stri
00000db0: 6e67 7b22 6122 7d7d 2c0a 0909 0972 6873  ng{"a"}},....rhs
00000dc0: 3a20 2020 2020 2026 736e 6943 6572 744b  :      &sniCertK
00000dd0: 6579 436f 6e74 656e 747b 6365 7274 4b65  eyContent{certKe
00000de0: 7943 6f6e 7465 6e74 3a20 6365 7274 4b65  yContent: certKe
00000df0: 7943 6f6e 7465 6e74 7b63 6572 743a 205b  yContent{cert: [
00000e00: 5d62 7974 6528 2262 6172 2229 2c20 6b65  ]byte("bar"), ke
00000e10: 793a 205b 5d62 7974 6528 2271 7578 2229  y: []byte("qux")
00000e20: 7d2c 2073 6e69 4e61 6d65 733a 205b 5d73  }, sniNames: []s
00000e30: 7472 696e 677b 2261 227d 7d2c 0a09 0909  tring{"a"}},....
00000e40: 6578 7065 6374 6564 3a20 6661 6c73 652c  expected: false,
00000e50: 0a09 097d 2c0a 0909 7b0a 0909 096e 616d  ...},...{....nam
00000e60: 653a 2020 2020 2022 6469 6666 6572 656e  e:     "differen
00000e70: 7420 6e61 6d65 7322 2c0a 0909 096c 6873  t names",....lhs
00000e80: 3a20 2020 2020 2026 736e 6943 6572 744b  :      &sniCertK
00000e90: 6579 436f 6e74 656e 747b 6365 7274 4b65  eyContent{certKe
00000ea0: 7943 6f6e 7465 6e74 3a20 6365 7274 4b65  yContent: certKe
00000eb0: 7943 6f6e 7465 6e74 7b63 6572 743a 205b  yContent{cert: [
00000ec0: 5d62 7974 6528 2266 6f6f 2229 2c20 6b65  ]byte("foo"), ke
00000ed0: 793a 205b 5d62 7974 6528 2262 617a 2229  y: []byte("baz")
00000ee0: 7d2c 2073 6e69 4e61 6d65 733a 205b 5d73  }, sniNames: []s
00000ef0: 7472 696e 677b 2261 227d 7d2c 0a09 0909  tring{"a"}},....
00000f00: 7268 733a 2020 2020 2020 2673 6e69 4365  rhs:      &sniCe
00000f10: 7274 4b65 7943 6f6e 7465 6e74 7b63 6572  rtKeyContent{cer
00000f20: 744b 6579 436f 6e74 656e 743a 2063 6572  tKeyContent: cer
00000f30: 744b 6579 436f 6e74 656e 747b 6365 7274  tKeyContent{cert
00000f40: 3a20 5b5d 6279 7465 2822 666f 6f22 292c  : []byte("foo"),
00000f50: 206b 6579 3a20 5b5d 6279 7465 2822 6261   key: []byte("ba
00000f60: 7a22 297d 2c20 736e 694e 616d 6573 3a20  z")}, sniNames: 
00000f70: 5b5d 7374 7269 6e67 7b22 6222 7d7d 2c0a  []string{"b"}},.
00000f80: 0909 0965 7870 6563 7465 643a 2066 616c  ...expected: fal
00000f90: 7365 2c0a 0909 7d2c 0a09 097b 0a09 0909  se,...},...{....
00000fa0: 6e61 6d65 3a20 2020 2020 2265 7874 7261  name:     "extra
00000fb0: 206e 616d 6573 222c 0a09 0909 6c68 733a   names",....lhs:
00000fc0: 2020 2020 2020 2673 6e69 4365 7274 4b65        &sniCertKe
00000fd0: 7943 6f6e 7465 6e74 7b63 6572 744b 6579  yContent{certKey
00000fe0: 436f 6e74 656e 743a 2063 6572 744b 6579  Content: certKey
00000ff0: 436f 6e74 656e 747b 6365 7274 3a20 5b5d  Content{cert: []
00001000: 6279 7465 2822 666f 6f22 292c 206b 6579  byte("foo"), key
00001010: 3a20 5b5d 6279 7465 2822 6261 7a22 297d  : []byte("baz")}
00001020: 2c20 736e 694e 616d 6573 3a20 5b5d 7374  , sniNames: []st
00001030: 7269 6e67 7b22 6122 7d7d 2c0a 0909 0972  ring{"a"}},....r
00001040: 6873 3a20 2020 2020 2026 736e 6943 6572  hs:      &sniCer
00001050: 744b 6579 436f 6e74 656e 747b 6365 7274  tKeyContent{cert
00001060: 4b65 7943 6f6e 7465 6e74 3a20 6365 7274  KeyContent: cert
00001070: 4b65 7943 6f6e 7465 6e74 7b63 6572 743a  KeyContent{cert:
00001080: 205b 5d62 7974 6528 2266 6f6f 2229 2c20   []byte("foo"), 
00001090: 6b65 793a 205b 5d62 7974 6528 2262 617a  key: []byte("baz
000010a0: 2229 7d2c 2073 6e69 4e61 6d65 733a 205b  ")}, sniNames: [
000010b0: 5d73 7472 696e 677b 2261 222c 2022 6222  ]string{"a", "b"
000010c0: 7d7d 2c0a 0909 0965 7870 6563 7465 643a  }},....expected:
000010d0: 2066 616c 7365 2c0a 0909 7d2c 0a09 7d0a   false,...},..}.
000010e0: 0a09 666f 7220 5f2c 2074 6573 7420 3a3d  ..for _, test :=
000010f0: 2072 616e 6765 2074 6573 7473 207b 0a09   range tests {..
00001100: 0974 2e52 756e 2874 6573 742e 6e61 6d65  .t.Run(test.name
00001110: 2c20 6675 6e63 2874 202a 7465 7374 696e  , func(t *testin
00001120: 672e 5429 207b 0a09 0909 6163 7475 616c  g.T) {....actual
00001130: 203a 3d20 7465 7374 2e6c 6873 2e45 7175   := test.lhs.Equ
00001140: 616c 2874 6573 742e 7268 7329 0a09 0909  al(test.rhs)....
00001150: 6966 2061 6374 7561 6c20 213d 2074 6573  if actual != tes
00001160: 742e 6578 7065 6374 6564 207b 0a09 0909  t.expected {....
00001170: 0974 2e45 7272 6f72 2861 6374 7561 6c29  .t.Error(actual)
00001180: 0a09 0909 7d0a 0909 7d29 0a09 7d0a 7d0a  ....}...})..}.}.
